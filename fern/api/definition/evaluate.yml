# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

services:
  http:
    EvaluateService:
      base-path: /
      auth: true 
      endpoints: 
        evaluate:
          path: /evaluate
          method: POST 
          request: fliptEvaluationRequest
          response: fliptEvaluationResponse
        batchEvaluate:
          path: /batch-evaluate
          method: POST 
          request: fliptBatchEvaluationRequest
          response: fliptBatchEvaluationResponse
        

types:
  fliptEvaluationRequest:
    properties:
      requestId: optional<string>
      flagKey: string 
      entityId: string 
      context: string

  fliptEvaluationResponse: 
    properties:
      requestId: string
      entityId: string 
      requestContext: string 
      match: boolean
      flagKey: string
      segmentKey: string 
      timestamp: datetime 
      value: string 
      requestDurationMillis: double 
      attachment: string 
      reasons: fliptEvaluationReason 

  fliptEvaluationReason: 
    enum:
      - UNKNOWN_EVALUATION_REASON
      - FLAG_DISABLED_EVALUATION_REASON
      - FLAG_NOT_FOUND_EVALUATION_REASON
      - MATCH_EVALUATION_REASON
      - ERROR_EVALUATION_REASON
      
  fliptBatchEvaluationRequest:
    properties:
      requestId: optional<string>
      requests: list<fliptEvaluationRequest>
      excludeNotFound: optional<boolean>

  fliptBatchEvaluationResponse: 
    properties:
      requestId: string 
      response: list<fliptEvaluationResponse>
      requestDurationMillis: double